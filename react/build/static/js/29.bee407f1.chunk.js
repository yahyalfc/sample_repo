(this.webpackJsonpklinker=this.webpackJsonpklinker||[]).push([[29],{243:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={returnTime:function(){var t=new Date,e=t.getHours(),n=t.getMinutes(),r=e>=12?"PM":"AM";return(e=(e%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+r},returnDate:function(){var t=new Date,e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),r=t.getFullYear();return e+"/"+n+"/"+r},convertDateFormat:function(t){var e=new Date(t),n=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear(),c=n+"/"+r+"/"+a,i=e.getHours(),o=e.getMinutes(),s=i>=12?"PM":"AM";return{date:c,time:(i=(i%=12)||12)+":"+(o=o<10?"0"+o:o)+" "+s}}}},496:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(115),a=n.n(r),c=n(111),i=n(116),o=n(39),s=(n(189),o.a.database().ref("users")),u={getNotification:function(t){return new Promise(function(){var e=Object(i.a)(a.a.mark((function e(n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s.child(t).child("notifications").on("child_added",(function(t){console.log("a new notification");var e=Object(c.a)({id:t.key},t.val());n({status:!0,data:e})}))}catch(a){console.log(a),r(a)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},getAllNotifications:function(t){return console.log({userID:t}),new Promise(function(){var e=Object(i.a)(a.a.mark((function e(n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[];try{s.child(t).child("notifications").on("value",(function(t){console.log("getting all notifications"),t.forEach((function(t){i.push(Object(c.a)(Object(c.a)({},t.val()),{},{id:t.key}))})),n({status:!0,data:i})}))}catch(a){console.log(a),r(a)}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},getNewNotifications:function(t){return new Promise(function(){var e=Object(i.a)(a.a.mark((function e(n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{i=[],s.child(t).child("notifications").orderByChild("notificationStatus").equalTo("new").on("value",(function(t){console.log("getting all new notifications"),t.forEach((function(t){i.push(Object(c.a)(Object(c.a)({},t.val()),{},{id:t.key}))})),n({status:!0,data:i})}))}catch(a){console.log(a),r(a)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},getNotificationById:function(t,e){return new Promise(function(){var n=Object(i.a)(a.a.mark((function n(r,i){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{console.log("getting notification by id"),s.child(t).child("notifications").child(e).once("value",(function(t){var e=Object(c.a)({id:t.key},t.val());r({status:!0,data:e})}))}catch(a){console.log(a),i(a)}case 1:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())},notificationRead:function(t,e){return new Promise(function(){var n=Object(i.a)(a.a.mark((function n(r,c){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{s.child(t).child("notifications").child(e).update({notificationStatus:"read"})}catch(r){console.log(r),c(r)}case 1:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())}}},498:function(t,e,n){"use strict";e.a=[{status:"confirmed",text:"confirmed the order."},{status:"fulfilled",text:"finalised the order."},{status:"cancelled",text:"cancelled the order"},{status:"invoice-generated",text:"generated invoice for the order"},{status:"supplier-items-added",text:"added extra items to order"}]},499:function(t,e,n){"use strict";e.a=[{status:"unapproved",text:"created an order"},{status:"reconfirmed",text:"confirmed the order"},{status:"cancelled",text:"cancelled the order"}]},849:function(t,e,n){"use strict";n.r(e);var r=n(32),a=n(452),c=n(646),i=n(2),o=n(111),s=n(127),u=n(17),l=n(39),d=(n(189),l.a.database().ref("users")),f=function(){var t=Object(i.useState)([]),e=Object(r.a)(t,2),n=e[0],a=e[1],c=Object(u.c)((function(t){return t.user})),l=Object(i.useState)(null),f=Object(r.a)(l,2),p=f[0],h=f[1];return Object(i.useEffect)((function(){try{d.child(c.id).child("notifications").on("value",(function(t){var e=[];t.forEach((function(t){e=[].concat(Object(s.a)(e),[Object(o.a)(Object(o.a)({},t.val()),{},{id:t.key})])})),a(e.sort((function(t,e){return e.createdAt-t.createdAt})))}))}catch(t){h(t)}}),[]),{allNotifications:n,error:p}},p=n(496),h=n(499),j=n(498),b=n(243),g=n(20),v=n(794),O=n.n(v),y=n(795),m=n.n(y),x=n(5);e.default=function(){var t=f(),e=t.allNotifications,n=(t.error,Object(i.useState)([])),o=Object(r.a)(n,2),s=o[0],l=o[1],d=Object(u.c)((function(t){return t.user})),v=Object(u.c)((function(t){return t.orders}));Object(i.useEffect)((function(){l(e)}),[e]);var y=function(t){var e=v.find((function(e){return e.orderID===t}));return"Supplier"==d.role?e.customerName:"Customer"==d.role?e.supplierName:void 0};return Object(x.jsxs)("div",{style:{padding:40},children:[Object(x.jsx)("h1",{style:{color:"gray"},children:"All notifications"}),Object(x.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:10,alignItems:"center"},children:Object(x.jsx)("div",{style:{width:"70%",border:"2px solid rgba(0, 0, 0, 0.05)"},children:s.map((function(t){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(g.b,{to:{pathname:"/app/".concat((n=d.role,"Supplier"==n?"supplier":"customer"),"/").concat(t.type,"?id=").concat(t.orderID)},children:Object(x.jsx)(a.a,{alignItems:"center",onClick:function(){return function(t){"order"==t.type&&p.a.notificationRead(d.id,t.id).then((function(t){}))}(t)},style:{padding:10},children:Object(x.jsxs)("div",{style:{},children:[Object(x.jsxs)("p",{style:{fontSize:15,color:"gray",padding:0,margin:0,display:"flex",flexWrap:"wrap"},children:[y(t.orderID)," ",(e=t.status,"Supplier"==d.role&&e?h.a.find((function(t){return t.status==e})).text:"Customer"==d.role&&e?j.a.find((function(t){return t.status==e})).text:e)]}),Object(x.jsx)("p",{style:{color:"gray"},children:Object(x.jsxs)("div",{style:{display:"inline-block"},children:[Object(x.jsx)(O.a,{fontSize:"small",style:{color:"#42a5f5"}})," ",Object(x.jsxs)("span",{style:{},children:[b.a.convertDateFormat(t.createdAt).time," ",Object(x.jsx)(m.a,{fontSize:"small"})," ",b.a.convertDateFormat(t.createdAt).date," "]})]})})]})})}),Object(x.jsx)(c.a,{})]});var e,n}))})})]})}}}]);
//# sourceMappingURL=29.bee407f1.chunk.js.map